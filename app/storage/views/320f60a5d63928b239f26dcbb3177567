
<?php $__env->startSection('content'); ?>
	<div class="col-md-12">
		<h3>
			<?php echo $title; ?>
			<a href="<?php echo URL::route('admin.pages'); ?>" class='btn btn-primary pull-right'>
				<span class="glyphicon glyphicon-chevron-left"></span> View All Pages
			</a>
		</h3>
		<hr/>

		<?php echo $__env->make('includes.alert', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>

		<div class="row">
			<?php echo Form::open(array('route' => array('admin.pages.edit',  $page->url), 'method' => 'put')); ?>
				<div class="col-md-4">
						<br/>
						<div class="alert alert-warning">
							<h4>Instructions:</h4>
							<ol>
								<li>Fields with <b>*</b> are required.</li>
								<li>Edit the form correctly.</li>
								<li>Click <b>update page</b> when you are done.</li>
							</ol>
						</div>
				</div>

				<div class="col-md-8">

					<?php echo Form::hidden('pageId', $page->id); ?>
			        
			        <div class="form-group">
			          	<?php echo Form::label('title', 'Title *'); ?>
			          	<?php echo Form::text('title', $page->title, array('class' => 'form-control title')); ?>
			          	<?php echo Form::error($errors, 'title'); ?>
			        </div>
			        
			        <?php if($page->can_delete): ?>
				        <div class="form-group">
				        	<?php echo Form::label('url', 'Url *'); ?>
				        	<div class="input-group">
						      	<span class="input-group-addon"> <?php echo Url::route('home'); ?>/</span>
						      	<?php echo Form::text('url', $page->url, array('class' => 'form-control url')); ?>
						    </div>
						    <?php echo Form::error($errors, 'url'); ?>
				        </div>
				    <?php endif; ?>

			        <div class="form-group">
			          	<?php echo Form::label('content', 'Content *'); ?>
			          	<?php echo Form::textarea('content', $page->content, array('class' => 'form-control', 'id' => 'editor')); ?>
			          	<?php echo Form::error($errors, 'content'); ?>
			        </div>

			        <?php if($page->can_delete): ?>
				        <div class="form-group">
					        <div class="checkbox">
							    <label>
									<?php echo Form::checkbox('is_public', '1', $page->is_public); ?> This Page is visible publicly
							    </label>
						  	</div>
						</div>
					<?php endif; ?>
		        	
		        	<?php echo Form::submit('Update Page', array('class' => 'btn btn-primary', 'data-loading-text' => 'Updating...', 'type' => 'button')); ?>
		        </div>
			<?php echo Form::close(); ?>
		</div>
	</div>

<?php $__env->stopSection(); ?>

<?php $__env->startSection('script'); ?>
	<script type="text/javascript">
		$(document).ready(function() {

			// gets slug/url
			$('.title').on('input', function() {
				$.post("<?php echo URL::route('admin.pages.generateUrl'); ?>", { title: $(this).val() })
				  	.done(function(slug) {
				    	$('.url').val(slug);
				});
			});


			CKEDITOR.replace('editor', {
		    	filebrowserUploadUrl: "<?php echo URL::to('upload'); ?>",
		    	"extraPlugins": "imagebrowser",
        		"imageBrowser_listUrl": "<?php echo URL::to('list'); ?>"
		    });
		});
	</script>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('layouts.admin', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>