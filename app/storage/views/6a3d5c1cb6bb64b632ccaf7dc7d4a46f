
<?php $__env->startSection('content'); ?>
	<div class="col-md-12">
		<h3>
			<?php echo $title; ?>
			<a href="<?php echo URL::route('admin.students.add'); ?>" class='btn btn-primary pull-right'>
				<span class="glyphicon glyphicon-plus"></span> Add New Student
			</a>
		</h3>
		<hr/>

		<?php echo $__env->make('includes.alert', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>
		<table class="table table-bordered table-striped">
			<thead>
				<tr>
					<th>Photo</th>
					<th>Reg.</th>
					<th>Full Name</th>
					<th>Email Address</th>
					<th>Mobile</th>
					<th>Action</th>
				</tr>
			</thead>
			<tbody>
				<?php foreach($students as $student): ?>
					<tr>
						<td><?php echo Helper::currentPicture($student, 'thumbnail'); ?></td>
						<td><?php echo $student->reg; ?></td>
						<td><?php echo $student->user->full_name; ?></td>
						<td>
							<a href="mailto:<?php echo $student->user->email; ?>"><?php echo $student->user->email; ?></a>
						</td>
						<td><?php echo $student->mobile; ?></td>
						<td>
							<div class="btn-group">
								<a href="<?php echo URL::route('admin.students.show', array('reg' => $student->reg));; ?>" class='btn btn-default btn-sm'>
						        	<span class="glyphicon glyphicon-zoom-in"></span> View
								</a>
		        				<a href="<?php echo URL::route('admin.students.edit', array('reg' => $student->reg)); ?>" class='btn btn-default btn-sm'>
		        					<span class="glyphicon glyphicon-edit"></span> Edit
		        				</a>
		        				<a href="#" class="btn btn-default btn-sm deleteBtn" data-toggle="modal" data-target="#deleteConfirm" deleteUserId="<?php echo $student->user_id; ?>">
		        					<span class="glyphicon glyphicon-trash"></span> Delete
		        				</a>
		        			</div>
						</td>
					</tr>
				<?php endforeach; ?>
			</tbody>
		</table>

		<div class="text-center"><?php echo $students->links(); ?></div>
	</div>

	<!-- Modal -->
	<div class="modal fade" id="deleteConfirm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static">
	  	<div class="modal-dialog">
	    	<div class="modal-content">
		      	<div class="modal-header">
		        	<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		        	<h4 class="modal-title" id="myModalLabel">Confirmation</h4>
		      	</div>
		      	<div class="modal-body">
					Are you sure to delete this student?
		      	</div>
		      	<div class="modal-footer">
		        	<?php echo Form::open(array('route' => array('admin.students.delete', 0), 'method'=> 'delete', 'class' => 'deleteForm')); ?>
		        		<button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
		        		<?php echo Form::submit('Yes, Delete', array('class' => 'btn btn-success')); ?>
		        	<?php echo Form::close(); ?>
		      	</div>
	    	</div>
		</div>
	</div>
<?php $__env->stopSection(); ?>

<?php $__env->startSection('script'); ?>
	<script type="text/javascript">
		$(document).ready(function() {
			
			// delete a student
			$('.deleteBtn').click(function() {
				var deleteUserId = $(this).attr('deleteUserId');
				var url = "<?php echo URL::route('admin.students'); ?>";
				$(".deleteForm").attr("action", url+'/'+deleteUserId);
			});

		});
	</script>
<?php $__env->stopSection(); ?>
<?php echo $__env->make('layouts.admin', array_except(get_defined_vars(), array('__data', '__path')))->render(); ?>